DEFINE JOB GL_BINARY
DESCRIPTION 'LOAD LOB DATA INTO GL_BINARY TABLE'
(
  DEFINE SCHEMA SOURCE_SCHEMA
  DESCRIPTION 'PRODUCT INFORMATION SCHEMA'
  (
    C_ID        VARCHAR(38),
    C_BLOB_COL  BLOB AS DEFERRED BY NAME,
    C_SRC_FILE  VARCHAR(30)
  );
  APPLY ('INSERT INTO ' || @SourceSchema || '.gl_binary (
            :C_ID
           ,SUBSTR(:C_BLOB_COL,1,2000)
           ,:C_BLOB_COL
           ,:C_SRC_FILE
           );'
         )
  TO OPERATOR ( $INSERTER() [1] ATTR (
                    Tdpid        = @Tdpid,
                    UserName     = @UserName,
                    UserPassword = @UserPassword)
              )
  SELECT * FROM OPERATOR (
            $FILE_READER (SOURCE_SCHEMA) [1]   ATTR (
                 TraceLevel    = 'None',
                 OpenMode      = 'Read',
                 DirectoryPath = @SourceDirectoryPath,
                 FileName      = 'gl_binary.dat',
                 Format        = 'delimited'
            )
  );
);
